# ๐ VPN Server Optimizer (opt.sh) โ V14.4.0

ุงุณฺฉุฑูพุช **ุจูููโุณุงุฒ ุณุฑูุฑ ูููฺฉุณ ุจุฑุง VPN** (ูุฎุตูุต ุงุณุชูุงุฏูโูุง ุณูฺฏู ู ุชุนุฏุงุฏ ฺฉุงุฑุจุฑ ุจุงูุง)  
ููุงุณุจ ุจุฑุง: **Xray (Reality / TCP / WS / gRPC)** ู **Hysteria2 (UDP/QUIC)**

---

## โจ ูฺฺฏโูุง (Features)

### ๐ ุดุจฺฉู ู TCP/UDP Tuning
- โ ูุนุงูโุณุงุฒ **BBR** (ุฏุฑ ุตูุฑุช ูพุดุชุจุงู ฺฉุฑูู) + ุงูุชุฎุงุจ ุฎูุฏฺฉุงุฑ **Qdisc** ููุงุณุจ
- โ ุชูุธูุงุช ูพุดุฑูุชูโ `sysctl` ุจุฑุง:
  - ุงูุฒุงุด ุชูุงู ูพุฑุฏุงุฒุด ุงุชุตุงูุงุช ููุฒูุงู
  - ฺฉุงูุด ูฺฏ ู ุจูุจูุฏ ูพุงุฏุงุฑ ุชุญุช ูุดุงุฑ
  - ุจูููโุณุงุฒ ุจุงูุฑูุง TCP/UDP ุจุฑุง ุณุฑุนุช ุจูุชุฑ
  - ุงูุฒุงุด `nf_conntrack_max` ุจุฑ ุงุณุงุณ RAM (ุจุง ุณูู ุงูู)

### ๐ก DNS Manager
- โ ุชุบุฑ DNS ุณุฑูุฑ ุจู ฺฉ ุงุฒ ฺฏุฒููโูุง:
  - Cloudflare / Google / Quad9 / OpenDNS / Shecan
  - ุง DNS ุฏูุฎูุงู (Custom)
- โ ุณุงุฒฺฏุงุฑ ุจุง:
  - `systemd-resolved` (Drop-in config + resolvectl)
  - ุง `resolv.conf` (ุฏุฑ ุณุณุชูโูุง ุจุฏูู resolved)

### ๐ MTU Optimization (Safe)
- โ ุชุดุฎุต **ุจูุชุฑู MTU ูุงุจูโุงุนุชูุงุฏ** ุจุง ุชุณุช Ping ู ุฌููฺฏุฑ ุงุฒ Fragment
- โ ุงุนูุงู MTU ุจู ุตูุฑุช Runtime ู ุฏุฑ ุตูุฑุช ูุฌูุฏ Netplan (Persist)
- ๐ฏ ููุฏ ุจุฑุง Reality/TCP ู ฺฉุงูุด ูุดฺฉูุงุช ูุทุน ู ูุงูพุงุฏุงุฑ ุดุจฺฉู

### ๐ง CPU Load Balancing (IRQ)
- โ ูุตุจ/ูุนุงูโุณุงุฒ `irqbalance`
- ๐ฏ ฺฉูฺฉ ุจู ุชูุณู ูุดุงุฑ SoftIRQ ุฑู ูุณุชูโูุง CPU  
  (ุฑู ุจุนุถ VMูุง ุงุซุฑ ฺฉูุชุฑูุ ูู ฺฉูโุฑุณฺฉ ู ุงุฑุฒุดููุฏ)

### ๐ง NIC Ring Buffer Tuning (ethtool)
- โ ุชูุธู ููุดููุฏ RX/TX Ring Buffers ุจุง `ethtool`
- โ **Fail-safe**:
  - ุงูู ูุงุจูุช NIC ุจุฑุฑุณ ูโุดูุฏ (`ethtool -g`)
  - ุณูพุณ ุฏุฑ ุตูุฑุช ูพุดุชุจุงู ุชูุงุด ุจู ุงูุฒุงุด ุงูุฌุงู ูโฺฏุฑุฏ
  - ุงฺฏุฑ ุงูฺฉุงูโูพุฐุฑ ูุจูุฏ ุจุฏูู ุฎุทุง ุฑุฏ ูโุดูุฏ

### ๐งพ Logging + Backup + Rollback
- โ ูุงฺฏโฺฏุฑ ุงูู:
  - ุชูุงุด ุจุฑุง `/var/log/...`
  - ุฏุฑ ุตูุฑุช ูุญุฏูุฏุชุ ุงูุชูุงู ุฎูุฏฺฉุงุฑ ุจู `/tmp/...`
- โ Rotate ูุงฺฏ ุจุฑ ุงุณุงุณ ุญุฌู/ุชุนุฏุงุฏ/ุฒูุงู
- โ ุจฺฉุงูพโฺฏุฑ ุงุฒ ูุงูโูุง ุชุบุฑุงูุชู ุฏุฑ:
  - `/root/vpn_optimizer_backups/<RUN_ID>/`
  - ู ููฺฉ `latest` ุจุฑุง ุขุฎุฑู ุงุฌุฑุง
- โ Rollback ุงูู ุจู ุขุฎุฑู ุจฺฉุงูพ

### ๐งฐ Firewall (UFW)
- โ ูุตุจ ู ูพฺฉุฑุจูุฏ UFW (ุงุฎุชุงุฑ)
- โ ุชุดุฎุต ูพูุฑุช SSH ู ุจุงุฒ ฺฏุฐุงุดุชู ุขู
- โ ุงูฺฉุงู ุงูุฒูุฏู ูพูุฑุชโูุง ุงุถุงู (ูุซูุงู 80/443/UDPโฆ)

### ๐ฅ๏ธ UI ุชูุฒ ู ุณุงุฒฺฏุงุฑ
- โ ุฑุงุจุท ฺฉุงุฑุจุฑ **ASCII-only** (ุจุฏูู ููฺฉุฏ/ุงููุฌ ุฏุงุฎู ุฎุฑูุฌ ุชุฑููุงู)
- โ ููุงุณุจ ุจุฑุง ุชุฑููุงูโูุง ฺฉู ููฺฉุฏ ุฑุง ุฎุฑุงุจ ููุงุด ูโุฏููุฏ (ุฑูุน ูุดฺฉู `????`)
- โ ููู ูุฑุชุจ + Progress Bar ุณุงุฏู ู ุดูุงู

---

## โ ูุตุจ ู ุงุฌุฑุง

### ๐ฅ ุฑูุด ูพุดููุงุฏ (Recommended)
```bash
wget -qO opt.sh "https://raw.githubusercontent.com/Sir-Adnan/server-tools/refs/heads/main/opt.sh" \
&& chmod +x opt.sh \
&& bash opt.sh
